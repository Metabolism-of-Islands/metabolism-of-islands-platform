<div id="resource-list">
  <input class="form-control search mb-4" type="text" placeholder="Search by title, author or year...">
  <div class="row list">
    {% for details in items %}
      <div class="col-md-6 mb-4">
        <a class="card btn-card single-resource" href="{{ details.get_absolute_url }}">
          <div class="card-body">
            <strong class="resource-title">{{ details.title }}</strong>
            {% if details.authors.all %}
              {% for author in details.authors.all %}
                <span class="resource-author">{{ author.firstname }} {{ author.lastname }}</span>{% if not forloop.counter == details.authors.all|length %},{% endif %}
              {% endfor %}
            {% else %}
              {{ details.authorlist }}
            {% endif %}
            {% if details.published_in %}<div class="resource-journal">{{ details.published_in }}</div>{% endif %}
            {% if details.type %}<div class="resource-type">{{ details.type }}</div>{% endif %}
            {% if details.year %}<div class="resource-year">{{ details.year }}</div>{% endif %}
          </div>
        </a>
      </div>
    {% endfor %}
  </div>

  <div class="card no-results">
    <div class="card-body text-center">
      <h2 class="my-4"><i class="fad fa-search"></i> No publications found</h2>
      <button class="btn btn-lg btn-primary clear-filter my-4">Show all publications</button>
    </div>
  </div>
</div>

{% block footer %}
  <!-- add listjs to search and filter -- https://listjs.com/api/ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/1.5.0/list.min.js"></script>

  <script>
    var listOptions = {
      valueNames: ["resource-title", "resource-author", "resource-journal", "resource-type", "resource-year"]
    };

    var resourceList = new List("resource-list", listOptions);

    // function to check the number of matches
    function checkCount() {
      var count = $(".single-resource:visible").length;
      if (count == 0) {
        $(".no-results").addClass("visible");
      } else {
        $(".no-results").removeClass("visible");
      }
    }

    // update contact count when searching by name
    resourceList.on("searchComplete", function(){
      checkCount();
    });

    // clear search and filters
    function resetSearchFilters() {
      resourceList.search();
      $("#resource-list input.search").val("");
    }

    $(".clear-filter").click(function() {
      resetSearchFilters();
      checkCount();
    })

    // reset all filters on page load
    resetSearchFilters();

    // make no results box invisible on load
    $(".no-results").removeClass("visible");
  </script>
{% endblock %}

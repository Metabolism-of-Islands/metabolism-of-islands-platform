{% extends "_base.html" %}

{% block page_name %}library item fullwidth{% endblock %}
{% block title %}{{ info }}{% endblock %}

{% block css %}
  <style type="text/css">
    .export, .audioblock {
      background:#f4f4f4;
    }
    .journal {
      max-height:160px;
    }
    .videoblock {
      background: #000;
    }
    .video-embed {
      width: 100%;
      height: 70vh;
    }
    .largeicon {
      font-size: 5rem;
    }
      
  </style>
{% endblock %}

{% block content %}

  <div class="container">
    <div class="row">
      <div class="col-lg-4 text-center">
        {% if info.publisher.image %}
          <a href="{{ info.publisher.get_absolute_url }}">
            <img src="{{ info.publisher.image.url }}" class="journal mt-4">
          </a>
        {% else %}
          <span class="largeicon">
            <i class="fal fa-{{ info.type.icon }}"></i>
          </span>
        {% endif %}
        {% if info.file %}
          <div class="mt-3 mb-2"><a href="{{ info.file.url }}" class="btn btn-primary"><i class="fa fa-download"></i> Download</a></div>
        {% endif %}
      </div>
      <div class="col-lg-8 mb-4">
        <div class="basic-details mb-4">
          <h1 class="item-title">{{ info }}</h1>
          <div><em>{{ info.type }}</em></div>
          {% if info.publisher %}
            <div><a href="{{ info.publisher.get_absolute_url }}">{{ info.publisher }}</a></div>
          {% endif %}
          <div>{{ info.year }}</div>
          <div>{{ info.authorlist }}</div>
        </div>
      </div>
    </div>
  </div>

  {% if info.type.name == "Video Recording" %}

    <div class="videoblock">
        {{ info.video.embed|safe }}
    </div>

  {% elif info.type.name == "Podcast" %}

    {% if info.file_url or info.file %}

      <div class="audioblock">
        <div class="container pt-5 pb-5">
          <h3>Listen now!</h3>
           <audio controls style="width:100%">
             <source src="{% if info.file_url %}{{ info.file_url }}{% else %}{{ info.file.url }}{% endif %}" type="audio/mp3">
             Your browser does not support the audio tag.
          </audio>
          <div>
            <a class="btn btn-default-outline" href="{% if info.file_url %}{{ info.file_url }}{% else %}{{ info.file.url }}{% endif %}">
              <i class="fa fa-download"></i>
              Download
            </a>
          </div>
        </div>
      </div>

    {% endif %}


  {% else %}

    {% if show_export %}

      <div class="export">
        <div class="container">
          <div class="row pt-4">
            <div class="col-lg-4 mb-4">
              <h4>Save</h4>
              <div class="row">
                <div class="col-md-12">
                  <a class="btn-icon" href="#">
                    <div class="title mb-0"><i class="fal fa-save fa-fw"></i> To my collection</div>
                  </a>
                </div>
                <div class="col-md-12">
                  <a class="btn-icon" href="#">
                    <div class="title mb-0"><i class="fal fa-folder-plus fa-fw"></i> Create new collection</div>
                  </a>
                </div>
              </div>
            </div>
            <div class="col-lg-8 mb-4">
              <h4>Export</h4>
              <div class="row">

                <div class="col-md-6">
                  <button class="btn-icon">
                    <div class="title mb-0"><i class="fal fa-file-export fa-fw"></i> RIS</div>
                  </button>
                </div>
                <div class="col-md-6">
                  <button class="btn-icon">
                    <div class="title mb-0"><i class="fal fa-file-export fa-fw"></i> Bibtex</div>
                  </button>
                </div>
                <div class="col-md-6">
                  <a class="btn-icon" href="#">
                    <div class="title mb-0"><i class="fal fa-quote-right fa-fw"></i> Citation</div>
                  </a>
                </div>
                <div class="col-md-6">
                  <a class="btn-icon" href="javascript:print()">
                    <div class="title mb-0"><i class="fal fa-print fa-fw"></i> Print</div>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    {% endif %}

  {% endif %}

  <div class="container pb-5 pt-3">

    <div class="row">

      {% if PROJECT.id == 8 %}

        <div class="col-lg-4">

          {% if info.author_list %}
            <div class="card">
              <ul class="list-group list-group-flush">
                <li class="list-group-item">
                  <i class="far fa-fw fa-user-edit mb-1 mr-1" aria-hidden="true"></i> 
                  <strong>
                  Author(s)
                  </strong>
                  <br>
                  {{ info.author_list }}
                </li>
              </ul>
            </div>
          {% endif %}

          {% for each in authors %}
            <div class="card mb-4 mt-4">
              <a href="{% url "ascus:participant" each.id %}">
                <img class="card-img-top" src="{{ each.image.thumbnail.url }}">
              </a>
              <div class="card-body">
                <div class="mb-4">
                  <h3>Uploaded by</h3>
                  <span class="details">
                    <a href="{% url "ascus:participant" each.id %}"><strong>{{ each }}</strong></a>
                    <br>
                    {{ each.email }}<br>
                  </span>
                  <p class="mt-4"><a href="{% url "ascus:participant" each.id %}">View profile</a></p>
                </div>

              </div>
            </div>
          {% endfor %}

        </div>

      {% else %}

        <div class="col-lg-4">
          <div class="card">
            <ul class="list-group list-group-flush">
              <li class="list-group-item">
                <i class="far fa-fw fa-user-edit mb-1 mr-1" aria-hidden="true"></i> Author(s)
                <br>
                {% for each in info.authors %}
                  <a class="btn btn-sm btn-primary-outline mt-1" href="">{{ each }}</a>
                {% endfor %}
              </li>
              {% if info.publisher %}
                <li class="list-group-item table-item">
                  <div><i class="far fa-fw fa-book mr-1"></i> Publisher</div>
                  <div>{{ info.publisher }}</div>
                </li>
              {% endif %}
              <li class="list-group-item">
                <i class="far fa-fw fa-tag mb-1 mr-1" aria-hidden="true"></i> Tags
                <br>
                {% for each in info.tags.all %}
                  <a class="btn btn-sm btn-primary-outline mt-1" href="{% url "library:index" %}?find=true&amp;search={{ each.id }}">{{ each }}</a>
                {% endfor %}
              </li>
              <li class="list-group-item table-item">
                <div><i class="far fa-fw fa-language mr-1"></i> Language</div>
                <div>{{ info.get_language_display }}</div>
              </li>
              <li class="list-group-item table-item">
                <div><i class="far fa-fw fa-universal-access mr-1"></i> Open access</div>
                <div><i class="fas fa-fw text-success fa-check-circle"></i></div>
              </li>
              {% if info.url %}
                <a class="list-group-item" href="{{ info.url }}">
                  <i class="far fa-fw fa-link mb-1 mr-1" aria-hidden="true"></i> External site
                </a>
              {% endif %}
              {% if info.doi %}
                <li class="list-group-item">
                  <i class="far fa-fw fa-tag mb-1 mr-1" aria-hidden="true"></i> DOI
                  <br>
                  <a class="badge badge-primary" href="https://doi.org/{{ info.doi }}">
                    {{ info.doi }}
                  </a>
                </li>
              {% endif %}
              {% if info.isbn %}
                <li class="list-group-item">
                  <i class="far fa-fw fa-tag mb-1 mr-1" aria-hidden="true"></i> ISBN
                  <br>
                  <span class="badge badge-primary">{{ info.isbn }}</span>
                </li>
              {% endif %}
              {% if info.type.group != "multimedia" %}
              <li class="list-group-item">
                <i class="far fa-fw fa-search mb-1 mr-1" aria-hidden="true"></i> Search
                <br>
                <a class="btn btn-sm btn-primary-outline mt-1" href="https://unpaywall.org/{{ info.doi }}">UnPaywall</a>
                <a class="btn btn-sm btn-primary-outline mt-1" href="https://scholar.google.com/scholar?q={{ info|urlencode }}">Google Scholar</a>
                <a class="btn btn-sm btn-primary-outline mt-1" href="https://google.com/search?q={{ info|urlencode }}">Google</a>
              </li>
              {% endif %}
            </ul>
          </div>
        </div>

      {% endif %}

      <div class="col-lg-8 mb-4">
        {{ info.description|safe|linebreaks }}

        {% include "_messages.html" %}
        
        <div class="mt-4"><a href="javascript:history.back()" class="btn btn-default-outline">&laquo; Back</a></div>
      </div>
    </div>
  </div>
{% endblock %}

{% extends "_base.html" %}

{% block title %}Data log{% endblock %}

{% block head %}
<style>
  .text-truncate {
    max-width: 200px;
  }
</style>
{% endblock %}

{% block content %}

  <h1>Data log</h1>

  <p>This page shows a log of all data entered into the system.</p>

  {% for key,data in types.items %}

    <h2 class="mt-5">{{ key }}</h2>
    <table class="table datatable">
      <thead>
        <tr>
          <th>Status</th>
          <th>From</th>
          <th>Until</th>
          <th>Type</th>
          {% if key == "Resources" or key == "Technology" %}
            <th>Name</th>
          {% endif %}
          <th>Quantity</th>
          <th>Organisation</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
      {% for each in data %}
        <tr>
          <td class="text-nowrap">
            {% if each.type == "demand" %}
              <i class="fal fa-sign-in fa-fw mr-2 text-secondary"></i> Demand
            {% else %}
              <i class="fal fa-sign-out fa-fw mr-2 text-primary"></i> Supply
            {% endif %}
          </td>
          <td class="text-nowrap">{{ each.start_date }}</td>
          <td class="text-nowrap">{{ each.end_date }}</td>
          {% if key == "Resources" or key == "Technology" %}
            <td>{{ each.material_type.parent }}</td>
          {% endif %}
          <td class="text-nowrap">
          {% if each.name %}
            {{ each.name }}<br>
          {% endif %}
          {{ each.material_type }}</td>
          <td class="text-nowrap">{{ each.absolute_quantity }} {{ each.unit.symbol }}</td>
          <td class="text-truncate">{{ each.owner }}</td>
          <td class="has-button">
            <a class="btn btn-sm btn-primary" href="{% url 'platformu:admin_datapoint' each.id %}"><i class="fa fa-info-circle m-0"></i></a>
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>

  {% endfor %}


{% endblock %}

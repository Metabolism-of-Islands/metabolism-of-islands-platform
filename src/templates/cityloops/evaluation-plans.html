{% extends "_base.html" %}
{% load static %}

{% block css %}
  <style>
    td.number {
      width: 48px;
      padding-right: 0;
    }

    .indicator-number {
      background-color: #144d58;
      color: #fff !important;
      padding: 0 .5rem;
      border-radius: .25rem;
      display: inline-block;
      font-weight: bold;
    }

    thead th:not(:last-of-type),
    tbody td:not(:last-of-type) {
      border-right: solid 1px #dee2e6;
    }

    tbody td:first-of-type {
      border-right: none;
    }

    th.city {
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      width: 120px;
      max-width:120px;
    }

    td.indicator-text {
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      width: 200px;
      max-width: 200px;
    }

    th.sticky-top {
      top: 0;
    }

    .filters label {
      margin-bottom: 0;
      font-weight: bold;
    }

    .badge.faded {
      opacity: .2;
    }
  </style>
{% endblock %}

{% block content %}
  <h1>Evaluation plans</h1>

  <div class="filters row">
    <div class="col-md-3">
      <div class="form-group">
        <label for="scales">Scales</label>
        <select id="scales" class="custom-select">
          <option value="all">Show all</option>
          <option value="c">City</option>
          <option value="da">Demonstration action</option>
          <option value="s">Sector</option>
        </select>
      </div>
    </div>
    <div class="col-md-9">
      <div class="form-group">
        <label for="cities">Cities</label>
        <select id="cities" class="custom-select" multiple>
          <option selected value="apeldoorn">Apeldoorn</option>
          <option selected value="bodo">Bodø</option>
          <option selected value="hoje">Høje-Taastrup</option>
          <option selected value="mikkeli">Mikkeli</option>
          <option selected value="porto">Porto</option>
          <option selected value="roskilde">Roskilde</option>
          <option selected value="sevilla">Sevilla</option>
        </select>
      </div>
    </div>
  </div>

  <div class="card card-table mb-4">
    <table class="table">
      <thead>
        <tr>
          <th class="sticky-top" colspan="2">Indicator</th>
          <th class="sticky-top city" data-city="apeldoorn"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Apeldoorn</a></th>
          <th class="sticky-top city" data-city="bodo"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Bodø</a></th>
          <th class="sticky-top city" data-city="hoje"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Høje-Taastrup</a></th>
          <th class="sticky-top city" data-city="mikkeli"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Mikkeli</a></th>
          <th class="sticky-top city" data-city="porto"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Porto</a></th>
          <th class="sticky-top city" data-city="roskilde"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Roskilde</a></th>
          <th class="sticky-top city" data-city="sevilla"><a href="{% url 'cityloops:dashboard_mockup' 'bodo' %}#evaluation-plan">Sevilla</a></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td colspan="9" class="ve bg-light font-weight-bold">
            1. Local stakeholder actions
          </td>
        </tr>

        <tr>
          <td class="number"><a href="{% url 'cityloops:indicators' %}" class="indicator-number">01</a></td>
          <td class="indicator-text">{% lorem 4 w random %}</td>
          <td data-city="apeldoorn">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-secondary selection" data-scale="da">DA</a>
          </td>
          <td data-city="bodo">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="hoje">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="mikkeli">
          </td>
          <td data-city="porto">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="roskilde">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="sevilla">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
        </tr>

        <tr>
          <td colspan="9" class="ve bg-light font-weight-bold">
            2. Circular business models and behavioural patterns
          </td>
        </tr>

        <tr>
          <td class="number"><a href="{% url 'cityloops:indicators' %}" class="indicator-number">02</a></td>
          <td class="indicator-text">{% lorem 4 w random %}</td>
          <td data-city="apeldoorn">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="bodo">
          </td>
          <td data-city="hoje">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="mikkeli">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="porto">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-secondary selection" data-scale="da">DA</a>
          </td>
          <td data-city="roskilde">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="sevilla">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-secondary selection" data-scale="da">DA</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
        </tr>

        <tr>
          <td colspan="9" class="ve bg-light font-weight-bold">
            3. Closing material loops and reducing harmful resource use
          </td>
        </tr>

        <tr>
          <td class="number"><a href="{% url 'cityloops:indicators' %}" class="indicator-number">03</a></td>
          <td class="indicator-text">{% lorem 4 w random %}</td>
          <td data-city="apeldoorn">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="bodo">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="hoje">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-secondary selection" data-scale="da">DA</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="mikkeli">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="porto">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="roskilde">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="sevilla">
          </td>
        </tr>

        <tr>
          <td colspan="9" class="ve bg-light font-weight-bold">
            4. Improving human well-being and reducing environmental impacts
          </td>
        </tr>

        <tr>
          <td class="number"><a href="{% url 'cityloops:indicators' %}" class="indicator-number">04</a></td>
          <td class="indicator-text">{% lorem 4 w random %}</td>
          <td data-city="apeldoorn">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="bodo">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="hoje">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-secondary selection" data-scale="da">DA</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="mikkeli">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
          </td>
          <td data-city="porto">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="roskilde">
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-cityloops-primary selection" data-scale="s">S</a>
            <a href="{% url 'cityloops:city_evaluation_plan_indicator' 'bodo' 1 %}" class="badge badge-secondary selection" data-scale="c">C</a>
          </td>
          <td data-city="sevilla">
          </td>
        </tr>
      </tbody>
    </table>
  </div>
{% endblock %}

{% block footer %}
  <script>
    // filter by scale
    $("select#scales").change(function() {
      let scale = $("select#scales").val();

      if (scale == "all") {
        $("table [data-scale]").removeClass("faded");
      } else {
        $("table [data-scale]").addClass("faded");
        $("table [data-scale='" + scale + "']").removeClass("faded");
      }

    })

    // filter cities
    $("select#cities").select2({
      closeOnSelect: false
    })

    $("select#cities").change(function() {
      let cities = $("select#cities").val();

      $("table [data-city]").attr("hidden", "hidden");

      $(cities).each(function() {
        $("table [data-city='" + this + "']").removeAttr("hidden");
      })
    })
  </script>
{% endblock %}
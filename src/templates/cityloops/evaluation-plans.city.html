{% extends "_base.html" %}
{% load static %}

{% block css %}
  <style>
    .table td {
      vertical-align: middle;
      padding: 1rem .75rem;
    }

    td.number {
      width: 48px;
      padding-right: 0;
    }

    td.checkbox {
      width: 48px;
      border-left: 1px solid #dee2e6
    }

    td.status {
      width: 150px;
      text-align: right;
    }

    .status .badge {
      padding: 0 0 0 .4rem;
    }

    .status .edit {
      height: 100%;
      padding: 6px .4em;
      margin-left: .4rem;
      display: inline-block;
      background-color: rgba(0,0,0,.5);
      border-top-right-radius: .25rem;
      border-bottom-right-radius: .25rem;
    }

    .indicator-number {
      background-color: #144d58;
      color: #fff;
      padding: 0 .5rem;
      border-radius: .25rem;
      display: inline-block;
      font-weight: bold;
    }
  </style>
{% endblock %}

{% block content %}

  {% include "_plans-menu-cityloops.html" %}

  <form>
    <div class="card card-table mb-4">
      <table class="table">
        <thead>
          <tr>
            <th colspan="2">Indicator</th>
            <th colspan="2" class="border-left">DA</th>
            <th colspan="2" class="border-left">Sector</th>
            <th colspan="2" class="border-left">City</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="number"><span class="indicator-number">01</span></td>
            <td>{% lorem 4 w random %}</td>
            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="1-da" checked>
                <label class="custom-control-label" for="1-da"></label>
              </div>
            </td>
            <td class="status">
              <a href="{% url 'cityloops:city_evaluation_plan' 'bodo' 1 %}" class="badge badge-lg badge-success">
                <i class="fa fa-check"></i> Completed <span class="edit"><i class="fa fa-fw fa-pencil-alt"></i></span>
              </a>
            </td>
            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="1-sector">
                <label class="custom-control-label" for="1-sector"></label>
              </div>
            </td>
            <td class="status"></td>

            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="1-city" checked>
                <label class="custom-control-label" for="1-city"></label>
              </div>
            </td>
            <td class="status">
              <a href="{% url 'cityloops:city_evaluation_plan' 'bodo' 1 %}" class="badge badge-lg badge-danger">
                <i class="fa fa-exclamation-triangle"></i> Unstarted <span class="edit"><i class="fa fa-fw fa-pencil-alt"></i></span>
              </a>
            </td>
          </tr>

          <tr>
            <td class="number"><span class="indicator-number">02</span></td>
            <td>{% lorem 5 w random %}</td>
            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="2-da">
                <label class="custom-control-label" for="2-da"></label>
              </div>
            </td>
            <td class="status">

            </td>
            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="2-sector" checked>
                <label class="custom-control-label" for="2-sector"></label>
              </div>
            </td>
            <td class="status">
              <a href="{% url 'cityloops:city_evaluation_plan' 'bodo' 1 %}" class="badge badge-lg badge-warning">
                <i class="fa fa-clock"></i> Unfinished <span class="edit"><i class="fa fa-fw fa-pencil-alt text-light"></i></span>
              </a>
            </td>

            <td class="checkbox">
              <div class="custom-control custom-switch">
                <input type="checkbox" class="custom-control-input" id="2-city" checked>
                <label class="custom-control-label" for="2-city"></label>
              </div>
            </td>
            <td class="status">
              <a href="{% url 'cityloops:city_evaluation_plan' 'bodo' 1 %}" class="badge badge-lg badge-success">
                <i class="fa fa-check"></i> Completed <span class="edit"><i class="fa fa-fw fa-pencil-alt"></i></span>
              </a>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <a href="{% url 'cityloops:city_evaluation_plan_form' 'bodo' 1 %}" class="btn btn-primary">
      <i class="fa fa-save"></i> Save
    </a>

  </form>

  <div class="mt-4">
    <div class="btn btn-primary download-pdf">
      <i class="fa fa-file-pdf"></i> Download .pdf
    </div>

    <div class="btn btn-primary download-word">
      <i class="fa fa-file-word"></i> Download .docx
    </div>
  </div>
{% endblock %}

{% block footer %}
  <!-- library for exporting to pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.2.0/jspdf.umd.min.js"></script>

  <!-- library for exporting to docx -->
  <script src="https://unpkg.com/docx@5.0.2/build/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script>

  <script>
    window.jsPDF = window.jspdf.jsPDF;

    /* global jsPDF */
    function downloadPDF() {
      var pdf = new jsPDF();
      pdf.text(20, 20, "Metabolism of Cities!");
      pdf.text(20, 30, "etc etc etc.");

      // Save the PDF
      pdf.save("report.pdf");
    }

    $(".download-pdf").click(function() {
      downloadPDF()
    });

    function downloadWord() {
      var word = new docx.Document();

      word.addSection({
        properties: {},
        children: [
          new docx.Paragraph({
            children: [
              new docx.TextRun("Metabolism of Cities!"),
              new docx.TextRun({
                text: "Etc etc etc",
              }),
            ],
          }),
        ],
      });

      docx.Packer.toBlob(word).then(blob => {
        saveAs(blob, "report.docx");
      });
    }

    $(".download-word").click(function() {
      downloadWord()
    });
  </script>
{% endblock %}
# Generated by Django 3.0.3 on 2020-05-14 05:27

import core.models
from django.conf import settings
import django.contrib.gis.db.models.fields
import django.contrib.postgres.fields.jsonb
from django.db import migrations, models
import django.db.models.deletion
import django.db.models.manager
import uuid


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('core', '0104_auto_20200514_0525'),
    ]

    operations = [
        migrations.CreateModel(
            name='Activity',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('code', models.CharField(blank=True, db_index=True, max_length=255, null=True)),
                ('is_separator', models.BooleanField()),
            ],
            options={
                'verbose_name_plural': 'activities',
                'db_table': 'stafdb_activity',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='ActivityCatalog',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('url', models.URLField(blank=True, null=True)),
            ],
            options={
                'verbose_name_plural': 'activity catalogs',
                'db_table': 'stafdb_activitycatalog',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='FlowDiagram',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
            ],
            options={
                'db_table': 'stafdb_flowdiagram',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='Geocode',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('depth', models.PositiveSmallIntegerField()),
            ],
            options={
                'db_table': 'stafdb_geocode',
                'ordering': ['depth', 'pk'],
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='MaterialCatalog',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('url', models.CharField(blank=True, max_length=255, null=True)),
            ],
            options={
                'db_table': 'stafdb_materialcatalog',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='ReferenceSpace',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('slug', models.CharField(max_length=255, null=True)),
            ],
            options={
                'db_table': 'stafdb_referencespace',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='UploadSession',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False)),
                ('meta_data', django.contrib.postgres.fields.jsonb.JSONField(blank=True, null=True)),
                ('part_of_project', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.Project')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'db_table': 'stafdb_uploadsession',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='UploadFile',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('file', models.FileField(upload_to=core.models.shapefile_directory)),
                ('session', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.UploadSession')),
            ],
            options={
                'db_table': 'stafdb_uploadfile',
            },
        ),
        migrations.CreateModel(
            name='Sector',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('icon', models.CharField(blank=True, max_length=255, null=True)),
                ('slug', models.SlugField(max_length=255)),
                ('activities', models.ManyToManyField(db_table='stafdb_sector_activities', to='core.Activity')),
                ('photo', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.Photo')),
            ],
            options={
                'db_table': 'stafdb_sector',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='ReferenceSpaceLocation',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('description', models.TextField(blank=True, null=True)),
                ('start', models.DateField(blank=True, db_index=True, null=True)),
                ('end', models.DateField(blank=True, db_index=True, null=True)),
                ('geometry', django.contrib.gis.db.models.fields.GeometryField(srid=4326)),
                ('is_deleted', models.BooleanField(db_index=True, default=False)),
                ('space', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.ReferenceSpace')),
            ],
            options={
                'db_table': 'stafdb_referencespace_location',
                'ordering': ['-start'],
            },
        ),
        migrations.CreateModel(
            name='ReferenceSpaceGeocode',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('identifier', models.CharField(blank=True, db_index=True, max_length=255, null=True)),
                ('geocode', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.Geocode')),
                ('space', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.ReferenceSpace')),
            ],
            options={
                'db_table': 'stafdb_referencespace_geocode',
            },
        ),
        migrations.AddField(
            model_name='referencespace',
            name='geocodes',
            field=models.ManyToManyField(through='core.ReferenceSpaceGeocode', to='core.Geocode'),
        ),
        migrations.AddField(
            model_name='referencespace',
            name='location',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.ReferenceSpaceLocation'),
        ),
        migrations.CreateModel(
            name='Material',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('code', models.CharField(blank=True, db_index=True, max_length=255, null=True)),
                ('catalog', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, to='core.MaterialCatalog')),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='core.Material')),
            ],
            options={
                'db_table': 'stafdb_material',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.CreateModel(
            name='GeocodeScheme',
            fields=[
                ('record_ptr', models.OneToOneField(auto_created=True, on_delete=django.db.models.deletion.CASCADE, parent_link=True, primary_key=True, serialize=False, to='core.Record')),
                ('url', models.URLField(blank=True, null=True)),
                ('is_comprehensive', models.BooleanField(db_index=True, default=True)),
                ('icon', models.CharField(blank=True, max_length=50, null=True)),
                ('coverage', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='core.ReferenceSpace')),
            ],
            options={
                'db_table': 'stafdb_geocode_scheme',
            },
            bases=('core.record',),
            managers=[
                ('objects_unfiltered', django.db.models.manager.Manager()),
            ],
        ),
        migrations.AddField(
            model_name='geocode',
            name='scheme',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='geocodes', to='core.GeocodeScheme'),
        ),
        migrations.CreateModel(
            name='FlowBlocks',
            fields=[
                ('id', models.AutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('origin_label', models.CharField(blank=True, max_length=255, null=True)),
                ('destination_label', models.CharField(blank=True, max_length=255, null=True)),
                ('description', models.TextField(blank=True, null=True)),
                ('destination', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='blocks_to', to='core.Activity')),
                ('diagram', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='blocks', to='core.FlowDiagram')),
                ('origin', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='blocks_from', to='core.Activity')),
            ],
            options={
                'db_table': 'stafdb_flowblocks',
            },
        ),
        migrations.AddField(
            model_name='activity',
            name='catalog',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='core.ActivityCatalog'),
        ),
        migrations.AddField(
            model_name='activity',
            name='parent',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='children', to='core.Activity'),
        ),
        migrations.AddField(
            model_name='activatedspace',
            name='space',
            field=models.ForeignKey(default=1, on_delete=django.db.models.deletion.CASCADE, to='core.ReferenceSpace'),
            preserve_default=False,
        ),
        migrations.AddField(
            model_name='photo',
            name='space',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='photo_gallery', to='core.ReferenceSpace'),
        ),
        migrations.AddField(
            model_name='record',
            name='sectors',
            field=models.ManyToManyField(blank=True, to='core.Sector'),
        ),
        migrations.AddField(
            model_name='record',
            name='spaces',
            field=models.ManyToManyField(blank=True, to='core.ReferenceSpace'),
        ),
    ]
